package pages

import (
	"fmt"
	"github.com/sei-shigeo/webApp/db"
)

templ EmployeesCard(employees []db.GetEmployeeCardListRow) {
	<div class="card-container">
		if len(employees) > 0 {
			for _, employee := range employees {
				@EmployeeCard(employee)
			}
		} else {
			<div class="no-employees">
				<span>No employees found</span>
			</div>
		}
	</div>
	<style>
		.card-container {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
			gap: var(--spacing-sm);
		}
		.card {
			display: grid;
			grid-template-columns: var(--card-image-size) 1fr auto;
			grid-template-rows: var(--card-image-size);
			align-items: center;
			border: 1px solid var(--sidebar-item-hover);
			border-radius: var(--border-radius-xs);
			background-color: var(--white);
			transition: box-shadow 0.2s ease;

			&:hover {
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
			}

			& > .image {
				width: var(--card-image-size);
				height: var(--card-image-size);
				object-fit: cover;
				border-top-left-radius: var(--border-radius-xs);
				border-bottom-left-radius: var(--border-radius-xs);
			}

			& > .content-list {
				display: flex;
				flex-direction: column;
				padding-inline: var(--spacing-md);
				overflow: hidden;

				& > .item {
					display: flex;
					align-items: center;
					gap: var(--spacing-sm);
					min-width: 0;

					& > .material-symbols-outlined {
						font-size: var(--icon-size-xs);
						flex-shrink: 0;
						color: var(--gray);
					}

					& > span:last-child {
						font-size: var(--font-size-xs);
						overflow: hidden;
						text-overflow: ellipsis;
						white-space: nowrap;
					}
				}
			}

			& > .print-button {
				color: var(--black);
				padding: var(--spacing-sm);
				border-radius: var(--border-radius-xs);
				transition: background-color 0.2s ease;

				&:hover {
					background-color: var(--sidebar-item-hover);
				}

				&:focus-visible {
					outline: 2px solid var(--primary);
					outline-offset: 2px;
				}

				& > .material-symbols-outlined {
					font-size: var(--icon-size-md);
				}
			}
		}
	</style>
}

templ EmployeeCard(employee db.GetEmployeeCardListRow) {
	<div class="card">
		<img
			class="image"
			src="https://placehold.jp/150x150.png"
			alt={ fmt.Sprintf("Employee %d: %s", employee.ID, employee.LastName+" "+employee.FirstName) }
		/>
		<ul class="content-list">
			<li class="item">
				<span class="material-symbols-outlined">badge</span>
				if employee.EmployeeCode != nil {
					<span>{ *employee.EmployeeCode }</span>
				} else {
					<span>-</span>
				}
			</li>
			<li class="item">
				<span class="material-symbols-outlined">person</span>
				<span>{ employee.LastName + " " + employee.FirstName }</span>
			</li>
			<li class="item">
				<span class="material-symbols-outlined">phone</span>
				if employee.PhoneNumber != nil {
					<span>{ *employee.PhoneNumber }</span>
				} else {
					<span>-</span>
				}
			</li>
			<li class="item">
				<span class="material-symbols-outlined">email</span>
				if employee.Email != nil {
					<span>{ *employee.Email }</span>
				} else {
					<span>-</span>
				}
			</li>
		</ul>
		<a class="print-button" href={ fmt.Sprintf("/employees/print/%d", employee.ID) } target="_blank">
			<span class="material-symbols-outlined">print</span>
		</a>
	</div>
}